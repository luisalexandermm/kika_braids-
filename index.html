<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/icon" href="img/logo.png">
    <title>Kika Braids - Peinados Afro y Trenzas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- API Service -->
    <script type="text/babel">
        const API_BASE = 'http://localhost:5000/api';

        const api = {
            // Servicios
            getServices: async () => {
                const res = await fetch(`${API_BASE}/services`);
                return res.json();
            },
            createService: async (service) => {
                const res = await fetch(`${API_BASE}/services`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(service)
                });
                return res.json();
            },
            updateService: async (id, service) => {
                const res = await fetch(`${API_BASE}/services/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(service)
                });
                return res.json();
            },
            deleteService: async (id) => {
                const res = await fetch(`${API_BASE}/services/${id}`, {
                    method: 'DELETE'
                });
                return res.json();
            },

            // Reservas
            getBookings: async () => {
                const res = await fetch(`${API_BASE}/bookings`);
                return res.json();
            },
            checkAvailability: async (date, time) => {
                const res = await fetch(`${API_BASE}/bookings/check-availability`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date, time })
                });
                return res.json();
            },
            createBooking: async (booking) => {
                const res = await fetch(`${API_BASE}/bookings`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(booking)
                });
                if (!res.ok) {
                    const error = await res.json();
                    throw new Error(error.error);
                }
                return res.json();
            },
            updateBooking: async (id, status) => {
                const res = await fetch(`${API_BASE}/bookings/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                return res.json();
            },
            deleteBooking: async (id) => {
                const res = await fetch(`${API_BASE}/bookings/${id}`, {
                    method: 'DELETE'
                });
                return res.json();
            },

            // Estad√≠sticas
            getStats: async () => {
                const res = await fetch(`${API_BASE}/stats`);
                return res.json();
            },

            // Testimonios
            getTestimonials: async () => {
                const res = await fetch(`${API_BASE}/testimonials`);
                return res.json();
            },
            getAllTestimonials: async () => {
                const res = await fetch(`${API_BASE}/testimonials/all`);
                return res.json();
            },
            createTestimonial: async (testimonial) => {
                const res = await fetch(`${API_BASE}/testimonials`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testimonial)
                });
                return res.json();
            },
            updateTestimonial: async (id, status) => {
                const res = await fetch(`${API_BASE}/testimonials/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                return res.json();
            },
            deleteTestimonial: async (id) => {
                const res = await fetch(`${API_BASE}/testimonials/${id}`, {
                    method: 'DELETE'
                });
                return res.json();
            }
        };
    </script>

    <!-- Toast Component -->
    <script type="text/babel">
        const Toast = ({ message, type, visible }) => {
            if (!visible) return null;
            return (
                <div className={`toast show ${type}`}>
                    {message}
                </div>
            );
        };
    </script>

    <!-- Service Card Component -->
    <script type="text/babel">
        const ServiceCard = ({ service, onBook }) => (
            <div className="service-card">
                <img 
                    src={service.image} 
                    alt={service.name} 
                    className="service-image"
                    onError={(e) => e.target.src = 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22300%22 height=%22300%22%3E%3Crect fill=%22%23e5e7eb%22 width=%22300%22 height=%22300%22/%3E%3C/svg%3E'}
                />
                <div className="service-content">
                    <h3>{service.name}</h3>
                    <p>{service.description}</p>
                    <div className="service-footer">
                        <span className="service-price">${service.price.toLocaleString('es-CO')}</span>
                        <button className="btn btn-small" onClick={() => onBook(service)}>Reservar</button>
                    </div>
                </div>
            </div>
        );
    </script>

    <!-- Header Component -->
    <script type="text/babel">
        const Header = ({ currentPage, onNavigate }) => {
            const [mobileMenuOpen, setMobileMenuOpen] = React.useState(false);

            const toggleMenu = () => setMobileMenuOpen(!mobileMenuOpen);
            const navigate = (page) => {
                onNavigate(page);
                setMobileMenuOpen(false);
            };

            return (
                <header id="header">
                    <div className="container">
                        <div className="header-content">
                            <a href="#" className="logo" onClick={(e) => { e.preventDefault(); navigate('home'); }}>
                                <div className="logo-icon">KB</div>
                                <span className="logo-text">Kika Braids</span>
                            </a>
                            <nav className="nav-desktop">
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('home'); }} 
                                   className={`nav-link ${currentPage === 'home' ? 'active' : ''}`}>Inicio</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('women'); }} 
                                   className={`nav-link ${currentPage === 'women' ? 'active' : ''}`}>üë© Mujeres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('men'); }} 
                                   className={`nav-link ${currentPage === 'men' ? 'active' : ''}`}>üë® Hombres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('booking'); }} 
                                   className={`nav-link ${currentPage === 'booking' ? 'active' : ''}`}>Reservar</a>
                            </nav>
                            <button className="mobile-menu-btn" onClick={toggleMenu}>
                                <span className="menu-icon">‚ò∞</span>
                            </button>
                        </div>
                        {mobileMenuOpen && (
                            <nav className="nav-mobile">
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('home'); }} className="nav-link-mobile">Inicio</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('women'); }} className="nav-link-mobile">üë© Mujeres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('men'); }} className="nav-link-mobile">üë® Hombres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('booking'); }} className="nav-link-mobile">Reservar</a>
                            </nav>
                        )}
                    </div>
                </header>
            );
        };
    </script>

    <!-- Home Page Component -->
    <script type="text/babel">
        const HomePage = ({ services, onNavigate, onBook, testimonials, onTestimonialAdded }) => {
        // Peinados por defecto
        const [showCommentForm, setShowCommentForm] = React.useState(false);
        const [commentForm, setCommentForm] = React.useState({
            name: '',
            email: '',
            rating: 5,
            message: '',
            service_name: ''
        });

        // Usar solo los servicios de la base de datos
        const defaultWomenServices = [
            { id: 'w1', name: 'Box Braids', description: 'Trenzas africanas cl√°sicas', price: 80000, image: 'img/box_braids.jpg' },
            { id: 'w2', name: 'Twists', description: 'Twists para cabello natural', price: 70000, image: 'img/twists.jpg' },
            { id: 'w3', name: 'Cornrows', description: 'Trenzas pegadas al cuero cabelludo', price: 60000, image: 'img/cornrows.jpg' },
            { id: 'w4', name: 'Trenzas', description: 'Trenzas tradicionales y modernas', price: 65000, image: '' },
            { id: 'w5', name: 'Definici√≥n de rizos', description: 'Definici√≥n profesional de rizos para cabello natural', price: 55000, image: '' }
        ];
        const defaultMenServices = [
            { id: 'm1', name: 'Trenzas Hombre', description: 'Trenzas modernas para hombres', price: 50000, image: 'img/trenzas_hombre.jpg' },
            { id: 'm2', name: 'Gusanillos', description: 'Gusanillos art√≠sticos', price: 45000, image: 'img/gusanillos.jpg' },
            { id: 'm3', name: 'Cornrows Hombre', description: 'Cornrows para hombres', price: 40000, image: 'img/cornrows_hombre.jpg' }
        ];

        const womenServices = services.women && services.women.length > 0 ? services.women.slice(0, 3) : defaultWomenServices.slice(0, 3);
        const menServices = services.men && services.men.length > 0 ? services.men.slice(0, 3) : defaultMenServices.slice(0, 3);
        const featuredServices = services.women && services.men && services.women.length > 1 && services.men.length > 0
            ? [services.women[0], services.men[0], services.women[1]].filter(Boolean)
            : [defaultWomenServices[0], defaultMenServices[0], defaultWomenServices[1]];

        const handleCommentChange = (e) => {
            const { name, value } = e.target;
            setCommentForm(prev => ({ ...prev, [name]: name === 'rating' ? parseInt(value) : value }));
        };

        const handleCommentSubmit = async (e) => {
            e.preventDefault();
            try {
                const result = await api.createTestimonial(commentForm);
                alert('¬°Gracias por tu comentario! Ser√° revisado y publicado pronto.');
                setCommentForm({ name: '', email: '', rating: 5, message: '', service_name: '' });
                setShowCommentForm(false);
                if (onTestimonialAdded) onTestimonialAdded();
            } catch (err) {
                alert('Error al enviar tu comentario');
            }
        };

        return (
                <div className="page active">
                    <section className="hero">
                        <div className="hero-overlay"></div>
                        <img src="img/logo.png" alt="Kika Braids" className="hero-image" />
                        <div className="hero-content">
                            <h1 className="hero-title">Kika Braids</h1>
                            <p className="hero-subtitle">Especialistas en Peinados Afro, Trenzas y Extensiones</p>
                            <div className="hero-buttons">
                                <button className="btn btn-primary" onClick={() => onNavigate('booking')}>Reservar Cita</button>
                                <button className="btn btn-secondary" onClick={() => onNavigate('women')}>Ver Servicios</button>
                            </div>
                        </div>
                    </section>

                    <section className="features">
                        <div className="container">
                            <div className="features-grid">
                                <div className="feature-card">
                                    <div className="feature-icon">‚ú®</div>
                                    <h3>Estilo √önico</h3>
                                    <p>Dise√±os personalizados seg√∫n tu tipo de cabello y preferencias</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üë•</div>
                                    <h3>Expertos Profesionales</h3>
                                    <p>Equipo certificado con 15+ a√±os de experiencia combinada</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üïê</div>
                                    <h3>Flexibilidad Horaria</h3>
                                    <p>Lunes a s√°bado con citas disponibles desde las 10:00</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üèÜ</div>
                                    <h3>Calidad Premium</h3>
                                    <p>Materiales de alta calidad con garant√≠a de durabilidad</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section className="services-section">
                        <div className="container">
                            <div className="section-header">
                                <h2>üåü Servicios Destacados</h2>
                                <p>Nuestros servicios m√°s populares y recomendados</p>
                            </div>
                            <div className="services-grid">
                                {featuredServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                            <div style={{ textAlign: 'center', marginTop: '2rem' }}>
                                <button className="btn btn-gradient" onClick={() => onNavigate('women')}>Ver todos los servicios ‚Üí</button>
                            </div>
                        </div>
                    </section>

                    <section className="services-section alt">
                        <div className="container">
                            <div className="section-header">
                                <h2>Servicios para Mujeres</h2>
                                <p>Trenzas africanas, box braids, extensiones y mucho m√°s para realzar tu belleza natural</p>
                            </div>
                            <div className="services-grid">
                                {womenServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                            <div style={{ textAlign: 'center', marginTop: '2rem' }}>
                                <button className="btn btn-gradient" onClick={() => onNavigate('women')}>Ver todos los servicios para mujeres ‚Üí</button>
                            </div>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="info-box">
                                <h2>¬øPor qu√© somos diferentes?</h2>
                                <div className="info-content">
                                    <p>üíé <strong>Extensiones Premium:</strong> Utilizamos extensiones 100% cabello natural de la m√°s alta calidad</p>
                                    <p>üé® <strong>Dise√±os Personalizados:</strong> Cada look se adapta perfectamente a tu tipo de cabello y estructura facial</p>
                                    <p>‚è±Ô∏è <strong>Durabilidad Garantizada:</strong> Nuestros trabajos duran 4-12 semanas con el cuidado adecuado</p>
                                    <p>üß¥ <strong>Consejos de Cuidado:</strong> Te ense√±amos c√≥mo mantener tu peinado en perfecto estado</p>
                                    <p>‚úÖ <strong>Satisfacci√≥n Garantizada:</strong> Si no te satisface el resultado, haremos ajustes sin costo</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section className="services-section alt">
                        <div className="container">
                            <div className="section-header">
                                <h2>Servicios para Hombres</h2>
                                <p>Trenzas modernas, gusanillos art√≠sticos y cuidado especializado para cabello afro</p>
                            </div>
                            <div className="services-grid">
                                {menServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                            <div style={{ textAlign: 'center', marginTop: '2rem' }}>
                                <button className="btn btn-gradient" onClick={() => onNavigate('men')}>Ver todos los servicios para hombres ‚Üí</button>
                            </div>
                        </div>
                    </section>

                    <section className="content-section alt">
                        <div className="container">
                            <h2 style={{ textAlign: 'center', marginBottom: '2rem' }}>Lo que dicen nuestros clientes</h2>
                            <div className="testimonials" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '2rem', marginBottom: '2rem' }}>
                                {testimonials && testimonials.length > 0 ? (
                                    testimonials.slice(0, 3).map(testimonial => (
                                        <div key={testimonial.id} style={{ background: '#f9fafb', padding: '1.5rem', borderRadius: '0.75rem', borderLeft: '4px solid var(--purple)' }}>
                                            <div style={{ display: 'flex', gap: '0.25rem', marginBottom: '1rem' }}>
                                                {Array(testimonial.rating).fill().map((_, i) => (
                                                    <span key={i} style={{ color: '#fbbf24', fontSize: '1.25rem' }}>‚≠ê</span>
                                                ))}
                                            </div>
                                            <p style={{ marginBottom: '1rem', fontStyle: 'italic', color: '#555' }}>"{testimonial.message}"</p>
                                            <p style={{ fontWeight: '600', margin: '0.5rem 0', fontSize: '0.875rem' }}>{testimonial.name}</p>
                                            {testimonial.service_name && <p style={{ margin: 0, color: '#666', fontSize: '0.875rem' }}>üìç {testimonial.service_name}</p>}
                                        </div>
                                    ))
                                ) : (
                                    <p style={{ textAlign: 'center', color: '#999', gridColumn: '1/-1' }}>S√© el primero en compartir tu experiencia</p>
                                )}
                            </div>
                            <div style={{ textAlign: 'center' }}>
                                <button className="btn btn-gradient" onClick={() => setShowCommentForm(!showCommentForm)}>
                                    {showCommentForm ? '‚úó Cerrar' : 'üí¨ Compartir tu experiencia'}
                                </button>
                            </div>

                            {showCommentForm && (
                                <div style={{ background: '#f3f4f6', borderRadius: '0.75rem', padding: '2rem', marginTop: '2rem', maxWidth: '600px', margin: '2rem auto' }}>
                                    <h3 style={{ marginBottom: '1.5rem' }}>Comparte tu experiencia</h3>
                                    <form onSubmit={handleCommentSubmit}>
                                        <div className="form-group">
                                            <label>üë§ Nombre *</label>
                                            <input type="text" name="name" required placeholder="Tu nombre"
                                                   value={commentForm.name} onChange={handleCommentChange} />
                                        </div>

                                        <div className="form-group">
                                            <label>üìß Correo Electr√≥nico *</label>
                                            <input type="email" name="email" required placeholder="tu@email.com"
                                                   value={commentForm.email} onChange={handleCommentChange} />
                                        </div>

                                    

                                        <div className="form-group">
                                            <label>üìã Servicio (opcional)</label>
                                            <input type="text" name="service_name" placeholder="Ej. Trenzas Box Braids"
                                                   value={commentForm.service_name} onChange={handleCommentChange} />
                                        </div>

                                        <div className="form-group">
                                            <label>üí¨ Tu comentario *</label>
                                            <textarea name="message" rows="5" required placeholder="Cu√©ntanos tu experiencia..."
                                                      value={commentForm.message} onChange={handleCommentChange}></textarea>
                                        </div>

                                        <button type="submit" className="btn btn-gradient btn-full">Enviar Comentario</button>
                                    </form>
                                </div>
                            )}
                        </div>
                </section>

                <section className="content-section">
                    <div className="container">
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1.5rem', marginTop: '2rem' }}>
                            <div>
                                <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>1Ô∏è‚É£</div>
                                <h3>Elige Servicio</h3>
                                <p>Explore nuestro cat√°logo de servicios</p>
                            </div>
                            <div>
                                <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>2Ô∏è‚É£</div>
                                <h3>Selecciona Fecha</h3>
                                <p>Verifica disponibilidad en tiempo real</p>
                            </div>
                            <div>
                                <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>3Ô∏è‚É£</div>
                                <h3>Confirma Cita</h3>
                                <p>Te contactamos en 24 horas</p>
                            </div>
                        </div>
                    </div>
                </section>

                    <section className="cta">
                        <div className="container">
                            <h2>¬øLista para tu nuevo look?</h2>
                            <p>Nuestras citas se agotan r√°pido. Reserva ahora mismo</p>
                            <button className="btn btn-white" onClick={() => onNavigate('booking')}>Reservar Ahora</button>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Women Page Component -->
    <script type="text/babel">
        const WomenPage = ({ services, onBook }) => {
            const defaultWomenServices = [
                { id: 'w1', name: 'Box Braids', description: 'Trenzas africanas cl√°sicas', price: 80000, image: 'img/box_braids.jpg' },
                { id: 'w2', name: 'Twists', description: 'Twists para cabello natural', price: 70000, image: 'img/twists.jpg' },
                { id: 'w3', name: 'Cornrows', description: 'Trenzas pegadas al cuero cabelludo', price: 60000, image: 'img/cornrows.jpg' },
                { id: 'w4', name: 'Trenzas', description: 'Trenzas tradicionales y modernas', price: 65000, image: '' },
                { id: 'w5', name: 'Definici√≥n de rizos', description: 'Definici√≥n profesional de rizos para cabello natural', price: 55000, image: '' }
            ];
            const womenServices = services.women && services.women.length > 0 ? services.women : defaultWomenServices;

            return (
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>üë© Servicios para Mujeres</h1>
                            <p>Peinados afro, trenzas y extensiones dise√±adas para realzar tu belleza natural</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="services-grid">
                                {womenServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="content-section alt">
                        <div className="container">
                            <div className="info-box">
                                <h2>¬øPor qu√© elegir nuestros servicios?</h2>
                                <div className="info-content">
                                    <p>‚ú® <strong>Estilo Personalizado:</strong> Cada look se adapta a tu tipo de cabello y preferencias</p>
                                    
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Men Page Component -->
    <script type="text/babel">
        const MenPage = ({ services, onBook }) => {
            const defaultMenServices = [
                { id: 'm1', name: 'Trenzas Hombre', description: 'Trenzas modernas para hombres', price: 50000, image: 'img/trenzas_hombre.jpg' },
                { id: 'm2', name: 'Gusanillos', description: 'Gusanillos art√≠sticos', price: 45000, image: 'img/gusanillos.jpg' },
                { id: 'm3', name: 'Cornrows Hombre', description: 'Cornrows para hombres', price: 40000, image: 'img/cornrows_hombre.jpg' }
            ];
            const menServices = services.men && services.men.length > 0 ? services.men : defaultMenServices;

            return (
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>üë® Servicios para Hombres</h1>
                            <p>Trenzas, gusanillos y tratamientos especializados con estilo masculino</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="services-grid">
                                {menServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="content-section alt">
                        <div className="container">
                            <div className="info-box">
                                <h2>Servicios de Calidad para Hombres</h2>
                                <div className="info-content">
                                    <p>‚ú® <strong>Dise√±os Modernos:</strong> Desde trenzas cl√°sicas hasta gusanillos con estilo</p>
                                    <p>üí™ <strong>Mantenimiento F√°cil:</strong> Nuestros trabajos son pr√°cticos y de bajo mantenimiento</p>
                                    <p>üéØ <strong>Profesionales Expertos:</strong> Especializados en cabello masculino afro</p>
                                    <p>üïê <strong>Duraci√≥n:</strong> Las trenzas duran 6-12 semanas seg√∫n el cuidado</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Gallery Page Component -->
    <script type="text/babel">
        const GalleryPage = () => null;
    </script>

    <!-- Booking Page Component -->
    <script type="text/babel">
        const BookingPage = ({ services, onBookingSubmit, selectedService }) => {
            const [formData, setFormData] = React.useState({
                name: '',
                email: '',
                phone: '',
                category: '', // mujeres/hombres
                service_id: '',
                date: '',
                time: '',
                notes: '',
                hair_type: '' // kanekalon o natural
            });
            const [availabilityChecking, setAvailabilityChecking] = React.useState(false);
            const [availabilityMessage, setAvailabilityMessage] = React.useState('');
            const [availabilityError, setAvailabilityError] = React.useState('');
  
            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const checkAvailability = async () => {
                if (!formData.date || !formData.time) {
                    setAvailabilityError('Por favor selecciona fecha y hora');
                    return;
                }
                
                setAvailabilityChecking(true);
                setAvailabilityError('');
                setAvailabilityMessage('');

                try {
                    const result = await api.checkAvailability(formData.date, formData.time);
                    if (result.available) {
                        setAvailabilityMessage('‚úÖ ' + result.message);
                    } else {
                        setAvailabilityError('‚ùå ' + result.message);
                    }
                } catch (err) {
                    setAvailabilityError('Error al verificar disponibilidad');
                }
                
                setAvailabilityChecking(false);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                // Validar campos obligatorios
                if (!formData.name || !formData.email || !formData.phone || !formData.service_id || !formData.hair_type || !formData.date || !formData.time) {
                    setAvailabilityError('Completa todos los campos obligatorios antes de confirmar la reserva');
                    return;
                }
                const allServices = [...(services.women || []), ...(services.men || [])];
                const service = allServices.find(s => s.id == formData.service_id);
                if (!service) {
                    setAvailabilityError('Servicio no encontrado');
                    return;
                }
                let price = service.price;
                if (formData.hair_type === 'kanekalon' && service.kanekalon) price = service.kanekalon;
                if (formData.hair_type === 'natural' && service.natural) price = service.natural;
                // Enviar reserva al backend
                const response = await fetch('/api/bookings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: formData.name,
                        email: formData.email,
                        phone: formData.phone,
                        service_id: formData.service_id,
                        service_name: service.name + ' (' + formData.hair_type + ')',
                        price,
                        date: formData.date,
                        time: formData.time,
                        notes: formData.notes
                    })
                });
                const data = await response.json();
                if (response.ok) {
                    setAvailabilityMessage('¬°Reserva enviada correctamente!');
                    setAvailabilityError('');
                    setTimeout(() => {
                        setFormData({ name: '', email: '', phone: '', category: '', service_id: '', date: '', time: '', notes: '', hair_type: '' });
                        setAvailabilityMessage('');
                        setAvailabilityError('');
                        if (typeof window !== 'undefined') {
                            window.location.hash = '#home';
                        }
                    }, 2000);
                } else {
                    setAvailabilityError(data.error || 'Error al crear la reserva');
                }
            };

            const allServices = [...(services.women || []), ...(services.men || [])];

            return (   
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>Reservar Cita</h1>
                            <p>Completa el formulario y nos pondremos en contacto contigo</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="form-container">
                                <form onSubmit={handleSubmit}>
                                    <div className="form-group">
                                        <label>üë§ Nombre Completo *</label>
                                        <input type="text" name="name" required placeholder="Tu nombre" 
                                               value={formData.name} onChange={handleChange} />
                                    </div>

                                    <div className="form-group">
                                        <label>üìß Correo Electr√≥nico *</label>
                                        <input type="email" name="email" required placeholder="tu@email.com"
                                               value={formData.email} onChange={handleChange} />
                                    </div>

                                    <div className="form-group">
                                        <label>üìû Tel√©fono *</label>
                                        <input type="tel" name="phone" required placeholder="+34 123 456 789"
                                               value={formData.phone} onChange={handleChange} />
                                    </div>

                                    {/* Solo una selecci√≥n de servicio, sin segundo servicio */}
                                    <div className="form-group">
                                        <label>Categor√≠a *</label>
                                        <select name="category" required value={formData.category} onChange={handleChange}>
                                            <option value="">servicio para </option>
                                            <option value="women">Mujer</option>
                                            <option value="men">Hombre</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Servicio *</label>
                                        <select name="service_id" required value={formData.service_id} onChange={handleChange} disabled={!formData.category}>
                                            <option value="">Selecciona un servicio</option>
                                            {formData.category === 'women' && (services.women || []).map(s => (
                                                <option key={s.id} value={s.id}>{s.name} - ${s.price.toLocaleString('es-CO')}</option>
                                            ))}
                                            {formData.category === 'men' && (services.men || []).map(s => (
                                                <option key={s.id} value={s.id}>{s.name} - ${s.price.toLocaleString('es-CO')}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Tipo de servicio *</label>
                                        <select name="hair_type" required value={formData.hair_type} onChange={handleChange}>
                                            <option value="">Selecciona tipo de cabello</option>
                                            <option value="kanekalon">Kanekalon</option>
                                            <option value="natural">Pelo natural</option>
                                        </select>
                                    </div>

                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>üìÖ Fecha *</label>
                                            <input type="date" name="date" required value={formData.date} onChange={handleChange} />
                                        </div>
                                        <div className="form-group">
                                            <label>üïê Hora *</label>
                                            <select name="time" required value={formData.time} onChange={handleChange}>
                                                <option value="">Selecciona una hora</option>
                                                {['10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00'].map(time => (
                                                    <option key={time} value={time}>{time}</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>

                                    <div style={{ marginBottom: '1rem', textAlign: 'center' }}>
                                        <button 
                                            type="button" 
                                            className="btn btn-gradient"
                                            onClick={checkAvailability}
                                            disabled={availabilityChecking}
                                        >
                                            {availabilityChecking ? '‚è≥ Verificando...' : 'üîç Verificar Disponibilidad'}
                                        </button>
                                        {availabilityMessage && <p style={{ color: '#10b981', fontSize: '0.875rem', marginTop: '0.5rem' }}>{availabilityMessage}</p>}
                                        {availabilityError && <p style={{ color: '#ef4444', fontSize: '0.875rem', marginTop: '0.5rem' }}>{availabilityError}</p>}
                                    </div>

                                    <div className="form-group">
                                        <label>üí¨ Notas adicionales (opcional)</label>
                                        <textarea name="notes" rows="4" placeholder="Cu√©ntanos sobre tu estilo deseado..."
                                                  value={formData.notes} onChange={handleChange}></textarea>
                                    </div>

                                    <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center' }}>
                                        <button type="submit" className="btn btn-gradient btn-full">Confirmar Reserva</button>
                                        <button type="button" className="btn btn-success btn-full" onClick={async () => {
                                            // Validar campos
                                            if (!formData.service_id || !formData.hair_type || !formData.name || !formData.phone || !formData.date || !formData.time) {
                                                setAvailabilityError('Completa todos los campos obligatorios antes de enviar por WhatsApp');
                                                return;
                                            }
                                            const allServices = [...(services.women || []), ...(services.men || [])];
                                            const service = allServices.find(s => s.id == formData.service_id);
                                            if (!service) {
                                                setAvailabilityError('Servicio no encontrado');
                                                return;
                                            }
                                            let price = service.price;
                                            if (formData.hair_type === 'kanekalon' && service.kanekalon) price = service.kanekalon;
                                            if (formData.hair_type === 'natural' && service.natural) price = service.natural;
                                            const whatsappNumber = '3116620413';
                                            const message = `Nueva reserva:\nNombre: ${formData.name}\nServicio: ${service.name} (${formData.hair_type})\nFecha: ${formData.date} a las ${formData.time}\nTel√©fono: ${formData.phone}\nNotas: ${formData.notes || ''}`;
                                            const whatsappUrl = `https://wa.me/57${whatsappNumber}?text=${encodeURIComponent(message)}`;
                                            window.open(whatsappUrl, '_blank');
                                        }}>Enviar por WhatsApp</button>
                                    </div>
                                </form>

                                <div className="info-box" style={{ marginTop: '2rem' }}>
                                    <h3>Informaci√≥n importante:</h3>
                                    <ul style={{ listStyle: 'none', padding: 0, marginTop: '1rem' }}>
                                        <li>‚Ä¢ Te contactaremos en las pr√≥ximas 24 horas para confirmar tu cita</li>
                                        <li>‚Ä¢ Los tiempos de servicio pueden variar seg√∫n el estilo elegido</li>
                                        <li>‚Ä¢ Te recomendamos llegar con el cabello limpio y seco</li>
                                        <li>‚Ä¢ Si necesitas cancelar, por favor av√≠sanos con 24 horas de anticipaci√≥n</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Admin Login Component -->
    <script type="text/babel">
        const AdminLogin = ({ onLogin }) => {
            const [password, setPassword] = React.useState('');
            const [error, setError] = React.useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (onLogin(password)) {
                    setPassword('');
                } else {
                    setError('Contrase√±a incorrecta');
                    setPassword('');
                }
            };

            return (
                <div className="page active">
                    <div className="admin-login">
                        <div className="admin-login-card">
                            <div className="admin-login-header">
                                <div className="admin-icon">üë§</div>
                                <h1>Panel de Administraci√≥n</h1>
                                <p>Kika Braids</p>
                            </div>
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>üîí Contrase√±a</label>
                                    <input type="password" required placeholder="Ingresa tu contrase√±a"
                                           value={password} onChange={(e) => { setPassword(e.target.value); setError(''); }} />
                                </div>
                                {error && <p style={{ color: '#ef4444', fontSize: '0.875rem', textAlign: 'center' }}>{error}</p>}
                                <button type="submit" className="btn btn-gradient btn-full">Iniciar Sesi√≥n</button>
                            </form>
                            <p style={{ textAlign: 'center', marginTop: '1rem', fontSize: '0.875rem', color: '#666' }}>
                                {/* Contrase√±a de ejemplo eliminada */}
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
    </script>

    <!-- Admin Dashboard Component -->
    <script type="text/babel">
        const AdminDashboard = ({ bookings, services, stats, testimonials, onLogout, onCompleteBooking, onDeleteBooking, onAddProduct, onUpdateProduct, onDeleteProduct, onApproveTestimonial, onDeleteTestimonial }) => {
            const [activeTab, setActiveTab] = React.useState('bookings');
            const [showAddProduct, setShowAddProduct] = React.useState(false);
            const [editingProduct, setEditingProduct] = React.useState(null);
            const [newProduct, setNewProduct] = React.useState({
                name: '',
                price: '',
                description: '',
                image: '',
                category: 'women'
            });

            const handleAddProduct = async (e) => {
                e.preventDefault();
                if (editingProduct) {
                    await onUpdateProduct(editingProduct.id, {
                        name: newProduct.name,
                        price: parseInt(newProduct.price),
                        description: newProduct.description,
                        image: newProduct.image,
                        category: newProduct.category
                    });
                    setEditingProduct(null);
                } else {
                    await onAddProduct({
                        name: newProduct.name,
                        price: parseInt(newProduct.price),
                        description: newProduct.description,
                        image: newProduct.image,
                        category: newProduct.category
                    });
                }
                setNewProduct({ name: '', price: '', description: '', image: '', category: 'women' });
                setShowAddProduct(false);
            };

            const startEdit = (product) => {
                setEditingProduct(product);
                setNewProduct(product);
                setShowAddProduct(true);
            };

            const allProducts = [...(services.women || []).map(p => ({...p, category: 'women'})), 
                                 ...(services.men || []).map(p => ({...p, category: 'men'}))];

            return (
                <div className="page active">
                    <header className="admin-header">
                        <div className="container">
                            <div className="admin-header-content">
                                <div>
                                    <h1 className="admin-title">Panel de Administraci√≥n</h1>
                                    <p className="admin-subtitle">Kika Braids</p>
                                </div>
                                <button className="btn btn-danger" onClick={onLogout}>üö™ Cerrar Sesi√≥n</button>
                            </div>
                        </div>
                    </header>

                    <main className="admin-main">
                        <div className="container">
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Reservas Pendientes</p>
                                            <p className="stat-value">{stats.pending}</p>
                                        </div>
                                        <div className="stat-icon">üïê</div>
                                    </div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Total Reservas</p>
                                            <p className="stat-value">{stats.total}</p>
                                        </div>
                                        <div className="stat-icon">üìÖ</div>
                                    </div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Ingresos Completados</p>
                                            <p className="stat-value">${stats.revenue?.toLocaleString('es-CO')}</p>
                                        </div>
                                        <div className="stat-icon">üìà</div>
                                    </div>
                                </div>
                            </div>

                            <div className="admin-tabs">
                                <div className="tabs-header">
                                    <button className={`tab-btn ${activeTab === 'bookings' ? 'active' : ''}`} 
                                            onClick={() => setActiveTab('bookings')}>
                                        üìÖ Reservas
                                    </button>
                                    <button className={`tab-btn ${activeTab === 'products' ? 'active' : ''}`} 
                                            onClick={() => setActiveTab('products')}>
                                        üì¶ Productos/Servicios
                                    </button>
                                    <button className={`tab-btn ${activeTab === 'testimonials' ? 'active' : ''}`} 
                                            onClick={() => setActiveTab('testimonials')}>
                                        üí¨ Comentarios ({testimonials?.filter(t => t.status === 'pending').length || 0})
                                    </button>
                                </div>

                                {activeTab === 'bookings' && (
                                    <div className="tab-content active">
                                        {bookings.length === 0 ? (
                                            <p style={{ textAlign: 'center', color: '#999', padding: '2rem' }}>No hay reservas a√∫n</p>
                                        ) : (
                                            bookings.map(booking => (
                                                <div key={booking.id} style={{ border: '1px solid #e5e7eb', borderRadius: '0.5rem', padding: '1.5rem', marginBottom: '1rem' }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
                                                        <div>
                                                            <h3 style={{ margin: 0, fontSize: '1.125rem' }}>{booking.name}</h3>
                                                            <p style={{ margin: '0.25rem 0', color: '#666', fontSize: '0.875rem' }}>{booking.service_name}</p>
                                                        </div>
                                                        <span style={{ background: booking.status === 'pending' ? '#fef3c7' : '#d1fae5', color: booking.status === 'pending' ? '#92400e' : '#065f46', padding: '0.25rem 0.75rem', borderRadius: '9999px', fontSize: '0.875rem', fontWeight: '600' }}>
                                                            {booking.status === 'pending' ? 'Pendiente' : 'Completada'}
                                                        </span>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', marginBottom: '1rem' }}>
                                                        <p><strong>üìß Email:</strong> {booking.email}</p>
                                                        <p><strong>üìû Tel√©fono:</strong> {booking.phone}</p>
                                                        <p><strong>üí∞ Precio:</strong> ${booking.price?.toLocaleString('es-CO')}</p>
                                                        <p><strong>üìÖ Fecha:</strong> {booking.date} a las {booking.time}</p>
                                                    </div>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button className="btn btn-small" 
                                                                onClick={() => onCompleteBooking(booking.id)}
                                                                disabled={booking.status === 'completed'}>
                                                            ‚úì Completar
                                                        </button>
                                                        <button className="btn btn-small btn-danger" 
                                                                onClick={() => onDeleteBooking(booking.id)}>
                                                            üóëÔ∏è Eliminar
                                                        </button>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                )}

                                {activeTab === 'products' && (
                                    <div className="tab-content active">
                                        <div className="tab-header">
                                            <h2>Servicios Disponibles</h2>
                                            <button className="btn btn-gradient" onClick={() => { setEditingProduct(null); setNewProduct({ name: '', price: '', description: '', image: '', category: 'women' }); setShowAddProduct(!showAddProduct); }}>
                                                ‚ûï Agregar Servicio
                                            </button>
                                        </div>

                                        {showAddProduct && (
                                            <div style={{ background: '#f9fafb', borderRadius: '0.5rem', padding: '1.5rem', marginBottom: '1.5rem' }}>
                                                      <h3>{editingProduct ? 'Editar Servicio' : 'Nuevo Servicio'}</h3>
                                                      <form onSubmit={handleAddProduct} encType="multipart/form-data">
                                                       <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>
                                                        <input type="text" placeholder="Nombre del servicio *" required
                                                            value={newProduct.name} onChange={(e) => setNewProduct({...newProduct, name: e.target.value})} />
                                                        <input type="number" placeholder="Precio base *" required
                                                            value={newProduct.price} onChange={(e) => setNewProduct({...newProduct, price: e.target.value})} />
                                                       </div>
                                                       <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>
                                                        <input type="number" placeholder="Precio Kanekalon" 
                                                            value={newProduct.kanekalon || ''} onChange={(e) => setNewProduct({...newProduct, kanekalon: e.target.value})} />
                                                        <input type="number" placeholder="Precio Pelo Natural" 
                                                            value={newProduct.natural || ''} onChange={(e) => setNewProduct({...newProduct, natural: e.target.value})} />
                                                       </div>
                                                    <textarea placeholder="Descripci√≥n" rows="3" style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                              value={newProduct.description} onChange={(e) => setNewProduct({...newProduct, description: e.target.value})}></textarea>
                                                    <div style={{ marginBottom: '1rem' }}>
                                                        <label style={{ fontWeight: '600', marginBottom: '0.5rem', display: 'block' }}>Imagen del servicio</label>
                                                        <input type="file" accept="image/*" onChange={async (e) => {
                                                            const file = e.target.files[0];
                                                            if (file) {
                                                                const formData = new FormData();
                                                                formData.append('image', file);
                                                                const res = await fetch('/api/upload', {
                                                                    method: 'POST',
                                                                    body: formData
                                                                });
                                                                const data = await res.json();
                                                                if (data.imageUrl) {
                                                                    setNewProduct({...newProduct, image: data.imageUrl});
                                                                }
                                                            }
                                                        }} />
                                                        {newProduct.image && <img src={newProduct.image} alt="preview" style={{ width: '100px', marginTop: '0.5rem', borderRadius: '0.5rem' }} />}
                                                    </div>
                                                    <input type="url" placeholder="URL de imagen (opcional)" style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                           value={newProduct.image} onChange={(e) => setNewProduct({...newProduct, image: e.target.value})} />
                                                    <select style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                            value={newProduct.category} onChange={(e) => setNewProduct({...newProduct, category: e.target.value})}>
                                                        <option value="women">Mujer</option>
                                                        <option value="men">Hombre</option>
                                                    </select>
                                                    <div style={{ display: 'flex', gap: '0.75rem' }}>
                                                        <button type="submit" className="btn btn-success">‚úì {editingProduct ? 'Guardar Cambios' : 'Guardar'}</button>
                                                        <button type="button" className="btn btn-secondary" onClick={() => setShowAddProduct(false)}>‚úó Cancelar</button>
                                                    </div>
                                                </form>
                                            </div>
                                        )}

                                        <div className="products-grid">
                                            {allProducts.map(product => (
                                                <div key={product.id} style={{ border: '1px solid #e5e7eb', borderRadius: '0.5rem', padding: '1rem', background: 'white' }}>
                                                    <h4 style={{ margin: '0 0 0.5rem 0' }}>{product.name}</h4>
                                                    <p style={{ margin: '0.5rem 0', color: '#666', fontSize: '0.875rem' }}>{product.description}</p>
                                                    <p style={{ margin: '0.5rem 0', color: 'var(--purple)', fontWeight: '600', fontSize: '1.25rem' }}>
                                                        ${product.price?.toLocaleString('es-CO')}
                                                    </p>
                                                    <p style={{ margin: '0.5rem 0', color: '#666', fontSize: '0.875rem' }}>
                                                        {product.category === 'women' ? 'üë© Servicio para Mujeres' : 'üë® Servicio para Hombres'}
                                                    </p>
                                                    <div style={{ margin: '0.5rem 0', color: '#333', fontSize: '0.95rem' }}>
                                                        <span style={{ fontWeight: '600' }}>Kanekalon:</span> ${product.kanekalon ? Number(product.kanekalon).toLocaleString('es-CO') : 'No especificado'}<br />
                                                        <span style={{ fontWeight: '600' }}>Pelo natural:</span> ${product.natural ? Number(product.natural).toLocaleString('es-CO') : 'No especificado'}
                                                    </div>
                                                    <div style={{ display: 'flex', gap: '0.5rem', marginTop: '1rem' }}>
                                                        <button className="btn btn-small" style={{ flex: 1 }} onClick={() => startEdit(product)}>Editar</button>
                                                        <button className="btn btn-small btn-danger" style={{ flex: 1 }} 
                                                                onClick={() => onDeleteProduct(product.id)}>
                                                            Eliminar
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'testimonials' && (
                                    <div className="tab-content active">
                                        <h2>Comentarios de Clientes</h2>
                                        {testimonials && testimonials.length === 0 ? (
                                            <p style={{ textAlign: 'center', color: '#999', padding: '2rem' }}>No hay comentarios a√∫n</p>
                                        ) : (
                                            <div>
                                                <div style={{ marginBottom: '2rem', padding: '1rem', background: '#fef3c7', borderRadius: '0.5rem', borderLeft: '4px solid #fbbf24' }}>
                                                    <p style={{ margin: 0, color: '#92400e' }}>
                                                        <strong>Pendientes de aprobaci√≥n:</strong> {testimonials?.filter(t => t.status === 'pending').length || 0}
                                                    </p>
                                                </div>
                                                {testimonials.map(testimonial => (
                                                    <div key={testimonial.id} style={{ border: '1px solid #e5e7eb', borderRadius: '0.5rem', padding: '1.5rem', marginBottom: '1rem', background: testimonial.status === 'pending' ? '#f9fafb' : 'white' }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
                                                            <div>
                                                                <h4 style={{ margin: 0 }}>{testimonial.name}</h4>
                                                                <p style={{ margin: '0.25rem 0', fontSize: '0.875rem', color: '#666' }}>{testimonial.email}</p>
                                                                <div style={{ display: 'flex', gap: '0.25rem', marginTop: '0.5rem' }}>
                                                                    {Array(testimonial.rating).fill().map((_, i) => (
                                                                        <span key={i} style={{ color: '#fbbf24' }}>‚≠ê</span>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                            <span style={{ background: testimonial.status === 'pending' ? '#fef3c7' : '#d1fae5', color: testimonial.status === 'pending' ? '#92400e' : '#065f46', padding: '0.25rem 0.75rem', borderRadius: '9999px', fontSize: '0.875rem', fontWeight: '600' }}>
                                                                {testimonial.status === 'pending' ? 'Pendiente' : 'Aprobado'}
                                                            </span>
                                                        </div>
                                                        <p style={{ margin: '1rem 0', color: '#555', fontStyle: 'italic' }}>"{testimonial.message}"</p>
                                                        {testimonial.service_name && <p style={{ margin: '0.5rem 0', color: '#666', fontSize: '0.875rem' }}>üìç Servicio: {testimonial.service_name}</p>}
                                                        <div style={{ display: 'flex', gap: '0.5rem', marginTop: '1rem' }}>
                                                            {testimonial.status === 'pending' && (
                                                                <button className="btn btn-small" onClick={() => onApproveTestimonial(testimonial.id)}>
                                                                    ‚úì Aprobar
                                                                </button>
                                                            )}
                                                            <button className="btn btn-small btn-danger" onClick={() => onDeleteTestimonial(testimonial.id)}>
                                                                üóëÔ∏è Eliminar
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };
    </script>

    <!-- Footer Component -->
    <script type="text/babel">
        const Footer = ({ onNavigate }) => (
            <footer id="footer">
                <div className="container">
                    <div className="footer-grid">
                        <div>
                            <h3 className="footer-title">Kika Braids</h3>
                            <p className="footer-text">Especialistas en peinados afro, trenzas y extensiones para mujeres y hombres.</p>
                            <div className="social-links">
                                <a href="#" className="social-link">üì∑</a>
                              
                            </div>
                        </div>

                        <div>
                            <h4 className="footer-heading">Contacto</h4>
                            <div className="footer-info">
                                <p>üìû 3116620413</p>
                                <p>üìß info@kikabraids.com</p>
                                <p>üìç Calle Principal 123, Madrid</p>
                            </div>
                        </div>

                        <div>
                            <h4 className="footer-heading">Horario</h4>
                            <div className="footer-info">
                                <p>Lunes - Viernes: 10:00 - 20:00</p>
                                <p>S√°bado: 10:00 - 18:00</p>
                                <p>Domingo: Cerrado</p>
                            </div>
                        </div>
                    </div>

                    <div className="footer-bottom">
                        <p>&copy; 2026 Kika Braids. Todos los derechos reservados.</p>
                        <a href="#" onClick={(e) => { e.preventDefault(); onNavigate('admin'); }} className="admin-link">Acceso Administrativo</a>
                    </div>
                </div>
            </footer>
        );
    </script>

    <!-- Main App Component -->
    <script type="text/babel">
        const App = () => {
            const [currentPage, setCurrentPage] = React.useState('home');
            const [selectedService, setSelectedService] = React.useState(null);
            const [services, setServices] = React.useState({ women: [], men: [] });
            const [bookings, setBookings] = React.useState([]);
            const [testimonials, setTestimonials] = React.useState([]);
            const [stats, setStats] = React.useState({ pending: 0, total: 0, revenue: 0 });
            const [adminAuthenticated, setAdminAuthenticated] = React.useState(false);
            const [toastMessage, setToastMessage] = React.useState('');
            const [toastType, setToastType] = React.useState('success');
            const [showToast, setShowToast] = React.useState(false);
            const [loading, setLoading] = React.useState(true);

            // Cargar datos
            React.useEffect(() => {
                loadData();
                const interval = setInterval(loadData, 5000); // Refresh cada 5 segundos
                return () => clearInterval(interval);
            }, []);

            const loadData = async () => {
                try {
                    const [servicesRes, bookingsRes, statsRes, testimonialsRes] = await Promise.all([
                        api.getServices(),
                        api.getBookings(),
                        api.getStats(),
                        api.getTestimonials()
                    ]);
                    setServices(servicesRes);
                    setBookings(bookingsRes);
                    setStats(statsRes);
                    setTestimonials(testimonialsRes);
                    setLoading(false);
                } catch (err) {
                    // No mostrar mensaje de error al usuario
                    setLoading(false);
                }
            };

            const showToastMessage = (message, type = 'success') => {
                setToastMessage(message);
                setToastType(type);
                setShowToast(true);
                setTimeout(() => setShowToast(false), 3000);
            };

            const handleNavigate = (page) => {
                setCurrentPage(page);
                window.scrollTo(0, 0);
            };

            const handleBook = (service) => {
                setSelectedService(service);
                handleNavigate('booking');
            };

            const handleBookingSubmit = async (formData) => {
                try {
                    await api.createBooking(formData);
                    showToastMessage('¬°Reserva enviada! El administrador se pondr√° en contacto pronto.');
                    await loadData();
                    setTimeout(() => handleNavigate('home'), 2000);
                } catch (err) {
                    showToastMessage(err.message || 'Error al crear la reserva', 'error');
                }
            };

            const handleAdminLogin = (password) => {
                // Permitir acceso si la contrase√±a es correcta o si el nombre ingresado es 'ericka'
                if (password === 'kikabraids2026' || password.toLowerCase() === 'ericka') {
                    setAdminAuthenticated(true);
                    showToastMessage('Sesi√≥n iniciada correctamente');
                    handleNavigate('admin-dashboard');
                    return true;
                }
                return false;
            };

            const handleAdminLogout = () => {
                setAdminAuthenticated(false);
                showToastMessage('Sesi√≥n cerrada');
                handleNavigate('home');
            };

            const handleCompleteBooking = async (bookingId) => {
                try {
                    await api.updateBooking(bookingId, 'completed');
                    showToastMessage('Reserva marcada como completada');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al actualizar reserva', 'error');
                }
            };

            const handleDeleteBooking = async (bookingId) => {
                if (confirm('¬øEst√°s seguro de que deseas eliminar esta reserva?')) {
                    try {
                        await api.deleteBooking(bookingId);
                        showToastMessage('Reserva eliminada');
                        await loadData();
                    } catch (err) {
                        showToastMessage('Error al eliminar reserva', 'error');
                    }
                }
            };

            const handleAddProduct = async (product) => {
                try {
                    await api.createService(product);
                    showToastMessage('Servicio agregado exitosamente');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al agregar servicio', 'error');
                }
            };

            const handleUpdateProduct = async (id, product) => {
                try {
                    await api.updateService(id, product);
                    showToastMessage('Servicio actualizado exitosamente');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al actualizar servicio', 'error');
                }
            };

            const handleDeleteProduct = async (productId) => {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este servicio?')) {
                    try {
                        await api.deleteService(productId);
                        showToastMessage('Servicio eliminado');
                        await loadData();
                    } catch (err) {
                        showToastMessage('Error al eliminar servicio', 'error');
                    }
                }
            };

            const handleApproveTestimonial = async (testimonialId) => {
                try {
                    await api.updateTestimonial(testimonialId, 'approved');
                    showToastMessage('Comentario aprobado');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al aprobar comentario', 'error');
                }
            };

            const handleDeleteTestimonial = async (testimonialId) => {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este comentario?')) {
                    try {
                        await api.deleteTestimonial(testimonialId);
                        showToastMessage('Comentario eliminado');
                        await loadData();
                    } catch (err) {
                        showToastMessage('Error al eliminar comentario', 'error');
                    }
                }
            };

            if (loading) {
                return <div className="loading-spinner">Kika Braids</div>;
            }

            return (
                <>
                    <Header currentPage={currentPage} onNavigate={handleNavigate} />
                    
                    {currentPage === 'home' && <HomePage services={services} onNavigate={handleNavigate} onBook={handleBook} testimonials={testimonials} onTestimonialAdded={loadData} />}
                    {currentPage === 'women' && <WomenPage services={services} onBook={handleBook} />}
                    {currentPage === 'men' && <MenPage services={services} onBook={handleBook} />}
                    {currentPage === 'booking' && <BookingPage services={services} onBookingSubmit={handleBookingSubmit} selectedService={selectedService} />}
                    
                    {currentPage === 'admin' && !adminAuthenticated && <AdminLogin onLogin={handleAdminLogin} />}
                    {currentPage === 'admin-dashboard' && adminAuthenticated && (
                        <AdminDashboard 
                            bookings={bookings} 
                            services={services}
                            stats={stats}
                            testimonials={testimonials}
                            onLogout={handleAdminLogout}
                            onCompleteBooking={handleCompleteBooking}
                            onDeleteBooking={handleDeleteBooking}
                            onAddProduct={handleAddProduct}
                            onUpdateProduct={handleUpdateProduct}
                            onDeleteProduct={handleDeleteProduct}
                            onApproveTestimonial={handleApproveTestimonial}
                            onDeleteTestimonial={handleDeleteTestimonial}
                        />
                    )}

                    <Footer onNavigate={handleNavigate} />
                    
                    <Toast message={toastMessage} type={toastType} visible={showToast} />
                </>
            );
        };

        // Renderizar la aplicaci√≥n
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>

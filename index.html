<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/icon" href="img/logo.png">
    <title>Kika Braids - Peinados Afro y Trenzas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- API Service -->
    <script type="text/babel">
        const API_BASE = 'http://localhost:5000/api';

        const api = {
            // Servicios
            getServices: async () => {
                const res = await fetch(`${API_BASE}/services`);
                return res.json();
            },
            createService: async (service) => {
                const res = await fetch(`${API_BASE}/services`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(service)
                });
                return res.json();
            },
            updateService: async (id, service) => {
                const res = await fetch(`${API_BASE}/services/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(service)
                });
                return res.json();
            },
            deleteService: async (id) => {
                const res = await fetch(`${API_BASE}/services/${id}`, {
                    method: 'DELETE'
                });
                return res.json();
            },

            // Reservas
            getBookings: async () => {
                const res = await fetch(`${API_BASE}/bookings`);
                return res.json();
            },
            checkAvailability: async (date, time) => {
                const res = await fetch(`${API_BASE}/bookings/check-availability`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date, time })
                });
                return res.json();
            },
            createBooking: async (booking) => {
                const res = await fetch(`${API_BASE}/bookings`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(booking)
                });
                if (!res.ok) {
                    const error = await res.json();
                    throw new Error(error.error);
                }
                return res.json();
            },
            updateBooking: async (id, status) => {
                const res = await fetch(`${API_BASE}/bookings/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                return res.json();
            },
            deleteBooking: async (id) => {
                const res = await fetch(`${API_BASE}/bookings/${id}`, {
                    method: 'DELETE'
                });
                return res.json();
            },

            // Estad√≠sticas
            getStats: async () => {
                const res = await fetch(`${API_BASE}/stats`);
                return res.json();
            }
        };
    </script>

    <!-- Toast Component -->
    <script type="text/babel">
        const Toast = ({ message, type, visible }) => {
            if (!visible) return null;
            return (
                <div className={`toast show ${type}`}>
                    {message}
                </div>
            );
        };
    </script>

    <!-- Service Card Component -->
    <script type="text/babel">
        const ServiceCard = ({ service, onBook }) => (
            <div className="service-card">
                <img 
                    src={service.image} 
                    alt={service.name} 
                    className="service-image"
                    onError={(e) => e.target.src = 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22300%22 height=%22300%22%3E%3Crect fill=%22%23e5e7eb%22 width=%22300%22 height=%22300%22/%3E%3C/svg%3E'}
                />
                <div className="service-content">
                    <h3>{service.name}</h3>
                    <p>{service.description}</p>
                    <div className="service-footer">
                        <span className="service-price">${service.price.toLocaleString('es-CO')}</span>
                        <button className="btn btn-small" onClick={() => onBook(service)}>Reservar</button>
                    </div>
                </div>
            </div>
        );
    </script>

    <!-- Header Component -->
    <script type="text/babel">
        const Header = ({ currentPage, onNavigate }) => {
            const [mobileMenuOpen, setMobileMenuOpen] = React.useState(false);

            const toggleMenu = () => setMobileMenuOpen(!mobileMenuOpen);
            const navigate = (page) => {
                onNavigate(page);
                setMobileMenuOpen(false);
            };

            return (
                <header id="header">
                    <div className="container">
                        <div className="header-content">
                            <a href="#" className="logo" onClick={(e) => { e.preventDefault(); navigate('home'); }}>
                                <div className="logo-icon">KB</div>
                                <span className="logo-text">Kika Braids</span>
                            </a>
                            <nav className="nav-desktop">
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('home'); }} 
                                   className={`nav-link ${currentPage === 'home' ? 'active' : ''}`}>Inicio</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('women'); }} 
                                   className={`nav-link ${currentPage === 'women' ? 'active' : ''}`}>üë© Mujeres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('men'); }} 
                                   className={`nav-link ${currentPage === 'men' ? 'active' : ''}`}>üë® Hombres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('gallery'); }} 
                                   className={`nav-link ${currentPage === 'gallery' ? 'active' : ''}`}>Galer√≠a</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('booking'); }} 
                                   className={`nav-link ${currentPage === 'booking' ? 'active' : ''}`}>Reservar</a>
                            </nav>
                            <button className="mobile-menu-btn" onClick={toggleMenu}>
                                <span className="menu-icon">‚ò∞</span>
                            </button>
                        </div>
                        {mobileMenuOpen && (
                            <nav className="nav-mobile">
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('home'); }} className="nav-link-mobile">Inicio</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('women'); }} className="nav-link-mobile">üë© Mujeres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('men'); }} className="nav-link-mobile">üë® Hombres</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('gallery'); }} className="nav-link-mobile">Galer√≠a</a>
                                <a href="#" onClick={(e) => { e.preventDefault(); navigate('booking'); }} className="nav-link-mobile">Reservar</a>
                            </nav>
                        )}
                    </div>
                </header>
            );
        };
    </script>

    <!-- Home Page Component -->
    <script type="text/babel">
        const HomePage = ({ services, onNavigate, onBook }) => {
            const womenServices = services.women ? services.women.slice(0, 3) : [];
            const menServices = services.men ? services.men.slice(0, 3) : [];

            return (
                <div className="page active">
                    <section className="hero">
                        <div className="hero-overlay"></div>
                        <img src="img/logo.png" alt="Kika Braids" className="hero-image" />
                        <div className="hero-content">
                            <h1 className="hero-title">Kika Braids</h1>
                            <p className="hero-subtitle">Especialistas en Peinados Afro, Trenzas y Extensiones</p>
                            <div className="hero-buttons">
                                <button className="btn btn-primary" onClick={() => onNavigate('booking')}>Reservar Cita</button>
                                <button className="btn btn-secondary" onClick={() => onNavigate('women')}>Ver Servicios</button>
                            </div>
                        </div>
                    </section>

                    <section className="features">
                        <div className="container">
                            <div className="features-grid">
                                <div className="feature-card">
                                    <div className="feature-icon">‚ú®</div>
                                    <h3>Estilo √önico</h3>
                                    <p>Dise√±os personalizados para tu look perfecto</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üë•</div>
                                    <h3>Expertos Profesionales</h3>
                                    <p>Equipo con a√±os de experiencia</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üïê</div>
                                    <h3>Horarios Flexibles</h3>
                                    <p>Adaptamos nuestro horario a tus necesidades</p>
                                </div>
                                <div className="feature-card">
                                    <div className="feature-icon">üèÜ</div>
                                    <h3>Calidad Premium</h3>
                                    <p>Productos de la m√°s alta calidad</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section className="services-section">
                        <div className="container">
                            <div className="section-header">
                                <h2>Servicios para Mujeres</h2>
                                <p>Peinados afro, trenzas y extensiones dise√±adas para realzar tu belleza natural</p>
                            </div>
                            <div className="services-grid">
                                {womenServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="services-section alt">
                        <div className="container">
                            <div className="section-header">
                                <h2>Servicios para Hombres</h2>
                                <p>Trenzas, gusanillos y definici√≥n de crespos con estilo masculino</p>
                            </div>
                            <div className="services-grid">
                                {menServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="cta">
                        <div className="container">
                            <h2>¬øLista para tu nuevo look?</h2>
                            <p>Reserva tu cita ahora y d√©janos crear el estilo perfecto para ti</p>
                            <button className="btn btn-white" onClick={() => onNavigate('booking')}>Reservar Ahora</button>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Women Page Component -->
    <script type="text/babel">
        const WomenPage = ({ services, onBook }) => {
            const womenServices = services.women || [];

            return (
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>üë© Servicios para Mujeres</h1>
                            <p>Peinados afro, trenzas y extensiones dise√±adas para realzar tu belleza natural</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="services-grid">
                                {womenServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="content-section alt">
                        <div className="container">
                            <div className="info-box">
                                <h2>¬øPor qu√© elegir nuestros servicios?</h2>
                                <div className="info-content">
                                    <p>‚ú® <strong>Estilo Personalizado:</strong> Cada look se adapta a tu tipo de cabello y preferencias</p>
                                    <p>üíé <strong>Extensiones Premium:</strong> Utilizamos las mejores extensiones del mercado</p>
                                    <p>üë± <strong>Profesionales Expertas:</strong> Nuestro equipo tiene a√±os de experiencia</p>
                                    <p>üïê <strong>Duraci√≥n:</strong> Nuestros trabajos duran 4-8 semanas con el cuidado adecuado</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Men Page Component -->
    <script type="text/babel">
        const MenPage = ({ services, onBook }) => {
            const menServices = services.men || [];

            return (
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>üë® Servicios para Hombres</h1>
                            <p>Trenzas, gusanillos y tratamientos especializados con estilo masculino</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="services-grid">
                                {menServices.map(service => (
                                    <ServiceCard key={service.id} service={service} onBook={onBook} />
                                ))}
                            </div>
                        </div>
                    </section>

                    <section className="content-section alt">
                        <div className="container">
                            <div className="info-box">
                                <h2>Servicios de Calidad para Hombres</h2>
                                <div className="info-content">
                                    <p>‚ú® <strong>Dise√±os Modernos:</strong> Desde trenzas cl√°sicas hasta gusanillos con estilo</p>
                                    <p>üí™ <strong>Mantenimiento F√°cil:</strong> Nuestros trabajos son pr√°cticos y de bajo mantenimiento</p>
                                    <p>üéØ <strong>Profesionales Expertos:</strong> Especializados en cabello masculino afro</p>
                                    <p>üïê <strong>Duraci√≥n:</strong> Las trenzas duran 6-12 semanas seg√∫n el cuidado</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Gallery Page Component -->
    <script type="text/babel">
        const GalleryPage = () => (
            <div className="page active">
                <section className="page-header">
                    <div className="container">
                        <h1>Galer√≠a de Estilos</h1>
                        <p>Descubre nuestros trabajos y encuentra tu inspiraci√≥n</p>
                    </div>
                </section>

                <section className="content-section">
                    <div className="container">
                        <div className="gallery">
                            {Array(12).fill().map((_, i) => (
                                <div key={i} className="gallery-item">
                                    <img src={`img/gallery-${i + 1}.jpg`} alt={`Galer√≠a ${i + 1}`} 
                                         onError={(e) => e.target.parentElement.innerHTML = `<div class="gallery-placeholder">Imagen ${i + 1}</div>`}
                                    />
                                </div>
                            ))}
                        </div>
                    </div>
                </section>

                <section className="content-section alt">
                    <div className="container text-center">
                        <h2>S√≠guenos en Instagram</h2>
                        <p style={{ marginBottom: '2rem' }}>Encuentra m√°s inspiraci√≥n y mantente al d√≠a con nuestros √∫ltimos trabajos</p>
                        <a href="https://instagram.com" target="_blank" rel="noopener noreferrer" className="btn btn-gradient">
                            üì∑ @kikabraids
                        </a>
                    </div>
                </section>
            </div>
        );
    </script>

    <!-- Booking Page Component -->
    <script type="text/babel">
        const BookingPage = ({ services, onBookingSubmit, selectedService }) => {
            const [formData, setFormData] = React.useState({
                name: '',
                email: '',
                phone: '',
                service_id: selectedService?.id || '',
                date: '',
                time: '',
                notes: ''
            });
            const [availabilityChecking, setAvailabilityChecking] = React.useState(false);
            const [availabilityMessage, setAvailabilityMessage] = React.useState('');
            const [availabilityError, setAvailabilityError] = React.useState('');

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const checkAvailability = async () => {
                if (!formData.date || !formData.time) {
                    setAvailabilityError('Por favor selecciona fecha y hora');
                    return;
                }
                
                setAvailabilityChecking(true);
                setAvailabilityError('');
                setAvailabilityMessage('');

                try {
                    const result = await api.checkAvailability(formData.date, formData.time);
                    if (result.available) {
                        setAvailabilityMessage('‚úÖ ' + result.message);
                    } else {
                        setAvailabilityError('‚ùå ' + result.message);
                    }
                } catch (err) {
                    setAvailabilityError('Error al verificar disponibilidad');
                }
                
                setAvailabilityChecking(false);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!formData.service_id) {
                    setAvailabilityError('Por favor selecciona un servicio');
                    return;
                }

                const allServices = [...(services.women || []), ...(services.men || [])];
                const service = allServices.find(s => s.id == formData.service_id);
                
                if (!service) {
                    setAvailabilityError('Servicio no encontrado');
                    return;
                }

                await onBookingSubmit({
                    name: formData.name,
                    email: formData.email,
                    phone: formData.phone,
                    service_id: formData.service_id,
                    service_name: service.name,
                    price: service.price,
                    date: formData.date,
                    time: formData.time,
                    notes: formData.notes
                });

                setFormData({ name: '', email: '', phone: '', service_id: '', date: '', time: '', notes: '' });
                setAvailabilityMessage('');
                setAvailabilityError('');
            };

            const allServices = [...(services.women || []), ...(services.men || [])];

            return (
                <div className="page active">
                    <section className="page-header">
                        <div className="container">
                            <h1>Reservar Cita</h1>
                            <p>Completa el formulario y nos pondremos en contacto contigo</p>
                        </div>
                    </section>

                    <section className="content-section">
                        <div className="container">
                            <div className="form-container">
                                <form onSubmit={handleSubmit}>
                                    <div className="form-group">
                                        <label>üë§ Nombre Completo *</label>
                                        <input type="text" name="name" required placeholder="Tu nombre" 
                                               value={formData.name} onChange={handleChange} />
                                    </div>

                                    <div className="form-group">
                                        <label>üìß Correo Electr√≥nico *</label>
                                        <input type="email" name="email" required placeholder="tu@email.com"
                                               value={formData.email} onChange={handleChange} />
                                    </div>

                                    <div className="form-group">
                                        <label>üìû Tel√©fono *</label>
                                        <input type="tel" name="phone" required placeholder="+34 123 456 789"
                                               value={formData.phone} onChange={handleChange} />
                                    </div>

                                    <div className="form-group">
                                        <label>Servicio *</label>
                                        <select name="service_id" required value={formData.service_id} onChange={handleChange}>
                                            <option value="">Selecciona un servicio</option>
                                            <optgroup label="Servicios para Mujeres">
                                                {(services.women || []).map(s => (
                                                    <option key={s.id} value={s.id}>{s.name} - ${s.price.toLocaleString('es-CO')}</option>
                                                ))}
                                            </optgroup>
                                            <optgroup label="Servicios para Hombres">
                                                {(services.men || []).map(s => (
                                                    <option key={s.id} value={s.id}>{s.name} - ${s.price.toLocaleString('es-CO')}</option>
                                                ))}
                                            </optgroup>
                                        </select>
                                    </div>

                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>üìÖ Fecha *</label>
                                            <input type="date" name="date" required value={formData.date} onChange={handleChange} />
                                        </div>
                                        <div className="form-group">
                                            <label>üïê Hora *</label>
                                            <select name="time" required value={formData.time} onChange={handleChange}>
                                                <option value="">Selecciona una hora</option>
                                                {['10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00'].map(time => (
                                                    <option key={time} value={time}>{time}</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>

                                    <div style={{ marginBottom: '1rem', textAlign: 'center' }}>
                                        <button 
                                            type="button" 
                                            className="btn btn-gradient"
                                            onClick={checkAvailability}
                                            disabled={availabilityChecking}
                                        >
                                            {availabilityChecking ? '‚è≥ Verificando...' : 'üîç Verificar Disponibilidad'}
                                        </button>
                                        {availabilityMessage && <p style={{ color: '#10b981', fontSize: '0.875rem', marginTop: '0.5rem' }}>{availabilityMessage}</p>}
                                        {availabilityError && <p style={{ color: '#ef4444', fontSize: '0.875rem', marginTop: '0.5rem' }}>{availabilityError}</p>}
                                    </div>

                                    <div className="form-group">
                                        <label>üí¨ Notas adicionales (opcional)</label>
                                        <textarea name="notes" rows="4" placeholder="Cu√©ntanos sobre tu estilo deseado..."
                                                  value={formData.notes} onChange={handleChange}></textarea>
                                    </div>

                                    <button type="submit" className="btn btn-gradient btn-full">Confirmar Reserva</button>
                                </form>

                                <div className="info-box" style={{ marginTop: '2rem' }}>
                                    <h3>Informaci√≥n importante:</h3>
                                    <ul style={{ listStyle: 'none', padding: 0, marginTop: '1rem' }}>
                                        <li>‚Ä¢ Te contactaremos en las pr√≥ximas 24 horas para confirmar tu cita</li>
                                        <li>‚Ä¢ Los tiempos de servicio pueden variar seg√∫n el estilo elegido</li>
                                        <li>‚Ä¢ Te recomendamos llegar con el cabello limpio y seco</li>
                                        <li>‚Ä¢ Si necesitas cancelar, por favor av√≠sanos con 24 horas de anticipaci√≥n</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
    </script>

    <!-- Admin Login Component -->
    <script type="text/babel">
        const AdminLogin = ({ onLogin }) => {
            const [password, setPassword] = React.useState('');
            const [error, setError] = React.useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (onLogin(password)) {
                    setPassword('');
                } else {
                    setError('Contrase√±a incorrecta');
                    setPassword('');
                }
            };

            return (
                <div className="page active">
                    <div className="admin-login">
                        <div className="admin-login-card">
                            <div className="admin-login-header">
                                <div className="admin-icon">üë§</div>
                                <h1>Panel de Administraci√≥n</h1>
                                <p>Kika Braids</p>
                            </div>
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>üîí Contrase√±a</label>
                                    <input type="password" required placeholder="Ingresa tu contrase√±a"
                                           value={password} onChange={(e) => { setPassword(e.target.value); setError(''); }} />
                                </div>
                                {error && <p style={{ color: '#ef4444', fontSize: '0.875rem', textAlign: 'center' }}>{error}</p>}
                                <button type="submit" className="btn btn-gradient btn-full">Iniciar Sesi√≥n</button>
                            </form>
                            <p style={{ textAlign: 'center', marginTop: '1rem', fontSize: '0.875rem', color: '#666' }}>
                                Contrase√±a de ejemplo: kikabraids2026
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
    </script>

    <!-- Admin Dashboard Component -->
    <script type="text/babel">
        const AdminDashboard = ({ bookings, services, stats, onLogout, onCompleteBooking, onDeleteBooking, onAddProduct, onUpdateProduct, onDeleteProduct }) => {
            const [activeTab, setActiveTab] = React.useState('bookings');
            const [showAddProduct, setShowAddProduct] = React.useState(false);
            const [editingProduct, setEditingProduct] = React.useState(null);
            const [newProduct, setNewProduct] = React.useState({
                name: '',
                price: '',
                description: '',
                image: '',
                category: 'women'
            });

            const handleAddProduct = async (e) => {
                e.preventDefault();
                if (editingProduct) {
                    await onUpdateProduct(editingProduct.id, {
                        name: newProduct.name,
                        price: parseInt(newProduct.price),
                        description: newProduct.description,
                        image: newProduct.image,
                        category: newProduct.category
                    });
                    setEditingProduct(null);
                } else {
                    await onAddProduct({
                        name: newProduct.name,
                        price: parseInt(newProduct.price),
                        description: newProduct.description,
                        image: newProduct.image,
                        category: newProduct.category
                    });
                }
                setNewProduct({ name: '', price: '', description: '', image: '', category: 'women' });
                setShowAddProduct(false);
            };

            const startEdit = (product) => {
                setEditingProduct(product);
                setNewProduct(product);
                setShowAddProduct(true);
            };

            const allProducts = [...(services.women || []).map(p => ({...p, category: 'women'})), 
                                 ...(services.men || []).map(p => ({...p, category: 'men'}))];

            return (
                <div className="page active">
                    <header className="admin-header">
                        <div className="container">
                            <div className="admin-header-content">
                                <div>
                                    <h1 className="admin-title">Panel de Administraci√≥n</h1>
                                    <p className="admin-subtitle">Kika Braids</p>
                                </div>
                                <button className="btn btn-danger" onClick={onLogout}>üö™ Cerrar Sesi√≥n</button>
                            </div>
                        </div>
                    </header>

                    <main className="admin-main">
                        <div className="container">
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Reservas Pendientes</p>
                                            <p className="stat-value">{stats.pending}</p>
                                        </div>
                                        <div className="stat-icon">üïê</div>
                                    </div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Total Reservas</p>
                                            <p className="stat-value">{stats.total}</p>
                                        </div>
                                        <div className="stat-icon">üìÖ</div>
                                    </div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-content">
                                        <div>
                                            <p className="stat-label">Ingresos Completados</p>
                                            <p className="stat-value">${stats.revenue?.toLocaleString('es-CO')}</p>
                                        </div>
                                        <div className="stat-icon">üìà</div>
                                    </div>
                                </div>
                            </div>

                            <div className="admin-tabs">
                                <div className="tabs-header">
                                    <button className={`tab-btn ${activeTab === 'bookings' ? 'active' : ''}`} 
                                            onClick={() => setActiveTab('bookings')}>
                                        üìÖ Reservas
                                    </button>
                                    <button className={`tab-btn ${activeTab === 'products' ? 'active' : ''}`} 
                                            onClick={() => setActiveTab('products')}>
                                        üì¶ Productos/Servicios
                                    </button>
                                </div>

                                {activeTab === 'bookings' && (
                                    <div className="tab-content active">
                                        {bookings.length === 0 ? (
                                            <p style={{ textAlign: 'center', color: '#999', padding: '2rem' }}>No hay reservas a√∫n</p>
                                        ) : (
                                            bookings.map(booking => (
                                                <div key={booking.id} style={{ border: '1px solid #e5e7eb', borderRadius: '0.5rem', padding: '1.5rem', marginBottom: '1rem' }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
                                                        <div>
                                                            <h3 style={{ margin: 0, fontSize: '1.125rem' }}>{booking.name}</h3>
                                                            <p style={{ margin: '0.25rem 0', color: '#666', fontSize: '0.875rem' }}>{booking.service_name}</p>
                                                        </div>
                                                        <span style={{ background: booking.status === 'pending' ? '#fef3c7' : '#d1fae5', color: booking.status === 'pending' ? '#92400e' : '#065f46', padding: '0.25rem 0.75rem', borderRadius: '9999px', fontSize: '0.875rem', fontWeight: '600' }}>
                                                            {booking.status === 'pending' ? 'Pendiente' : 'Completada'}
                                                        </span>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', marginBottom: '1rem' }}>
                                                        <p><strong>üìß Email:</strong> {booking.email}</p>
                                                        <p><strong>üìû Tel√©fono:</strong> {booking.phone}</p>
                                                        <p><strong>üí∞ Precio:</strong> ${booking.price?.toLocaleString('es-CO')}</p>
                                                        <p><strong>üìÖ Fecha:</strong> {booking.date} a las {booking.time}</p>
                                                    </div>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button className="btn btn-small" 
                                                                onClick={() => onCompleteBooking(booking.id)}
                                                                disabled={booking.status === 'completed'}>
                                                            ‚úì Completar
                                                        </button>
                                                        <button className="btn btn-small btn-danger" 
                                                                onClick={() => onDeleteBooking(booking.id)}>
                                                            üóëÔ∏è Eliminar
                                                        </button>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                )}

                                {activeTab === 'products' && (
                                    <div className="tab-content active">
                                        <div className="tab-header">
                                            <h2>Servicios Disponibles</h2>
                                            <button className="btn btn-gradient" onClick={() => { setEditingProduct(null); setNewProduct({ name: '', price: '', description: '', image: '', category: 'women' }); setShowAddProduct(!showAddProduct); }}>
                                                ‚ûï Agregar Servicio
                                            </button>
                                        </div>

                                        {showAddProduct && (
                                            <div style={{ background: '#f9fafb', borderRadius: '0.5rem', padding: '1.5rem', marginBottom: '1.5rem' }}>
                                                <h3>{editingProduct ? 'Editar Servicio' : 'Nuevo Servicio'}</h3>
                                                <form onSubmit={handleAddProduct}>
                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>
                                                        <input type="text" placeholder="Nombre del servicio *" required
                                                               value={newProduct.name} onChange={(e) => setNewProduct({...newProduct, name: e.target.value})} />
                                                        <input type="number" placeholder="Precio *" required
                                                               value={newProduct.price} onChange={(e) => setNewProduct({...newProduct, price: e.target.value})} />
                                                    </div>
                                                    <textarea placeholder="Descripci√≥n" rows="3" style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                              value={newProduct.description} onChange={(e) => setNewProduct({...newProduct, description: e.target.value})}></textarea>
                                                    <input type="url" placeholder="URL de imagen" style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                           value={newProduct.image} onChange={(e) => setNewProduct({...newProduct, image: e.target.value})} />
                                                    <select style={{ width: '100%', marginBottom: '1rem', padding: '0.5rem 0.75rem', border: '1px solid #e5e7eb', borderRadius: '0.5rem' }}
                                                            value={newProduct.category} onChange={(e) => setNewProduct({...newProduct, category: e.target.value})}>
                                                        <option value="women">Mujer</option>
                                                        <option value="men">Hombre</option>
                                                    </select>
                                                    <div style={{ display: 'flex', gap: '0.75rem' }}>
                                                        <button type="submit" className="btn btn-success">‚úì {editingProduct ? 'Guardar Cambios' : 'Guardar'}</button>
                                                        <button type="button" className="btn btn-secondary" onClick={() => setShowAddProduct(false)}>‚úó Cancelar</button>
                                                    </div>
                                                </form>
                                            </div>
                                        )}

                                        <div className="products-grid">
                                            {allProducts.map(product => (
                                                <div key={product.id} style={{ border: '1px solid #e5e7eb', borderRadius: '0.5rem', padding: '1rem', background: 'white' }}>
                                                    <h4 style={{ margin: '0 0 0.5rem 0' }}>{product.name}</h4>
                                                    <p style={{ margin: '0.5rem 0', color: '#666', fontSize: '0.875rem' }}>{product.description}</p>
                                                    <p style={{ margin: '0.5rem 0', color: 'var(--purple)', fontWeight: '600', fontSize: '1.25rem' }}>
                                                        ${product.price?.toLocaleString('es-CO')}
                                                    </p>
                                                    <p style={{ margin: '0.5rem 0', color: '#666', fontSize: '0.875rem' }}>
                                                        {product.category === 'women' ? 'üë© Servicio para Mujeres' : 'üë® Servicio para Hombres'}
                                                    </p>
                                                    <div style={{ display: 'flex', gap: '0.5rem', marginTop: '1rem' }}>
                                                        <button className="btn btn-small" style={{ flex: 1 }} onClick={() => startEdit(product)}>Editar</button>
                                                        <button className="btn btn-small btn-danger" style={{ flex: 1 }} 
                                                                onClick={() => onDeleteProduct(product.id)}>
                                                            Eliminar
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };
    </script>

    <!-- Footer Component -->
    <script type="text/babel">
        const Footer = ({ onNavigate }) => (
            <footer id="footer">
                <div className="container">
                    <div className="footer-grid">
                        <div>
                            <h3 className="footer-title">Kika Braids</h3>
                            <p className="footer-text">Especialistas en peinados afro, trenzas y extensiones para mujeres y hombres.</p>
                            <div className="social-links">
                                <a href="#" className="social-link">üì∑</a>
                                <a href="#" className="social-link">üìò</a>
                            </div>
                        </div>

                        <div>
                            <h4 className="footer-heading">Contacto</h4>
                            <div className="footer-info">
                                <p>üìû +34 123 456 789</p>
                                <p>üìß info@kikabraids.com</p>
                                <p>üìç Calle Principal 123, Madrid</p>
                            </div>
                        </div>

                        <div>
                            <h4 className="footer-heading">Horario</h4>
                            <div className="footer-info">
                                <p>Lunes - Viernes: 10:00 - 20:00</p>
                                <p>S√°bado: 10:00 - 18:00</p>
                                <p>Domingo: Cerrado</p>
                            </div>
                        </div>
                    </div>

                    <div className="footer-bottom">
                        <p>&copy; 2026 Kika Braids. Todos los derechos reservados.</p>
                        <a href="#" onClick={(e) => { e.preventDefault(); onNavigate('admin'); }} className="admin-link">Acceso Administrativo</a>
                    </div>
                </div>
            </footer>
        );
    </script>

    <!-- Main App Component -->
    <script type="text/babel">
        const App = () => {
            const [currentPage, setCurrentPage] = React.useState('home');
            const [selectedService, setSelectedService] = React.useState(null);
            const [services, setServices] = React.useState({ women: [], men: [] });
            const [bookings, setBookings] = React.useState([]);
            const [stats, setStats] = React.useState({ pending: 0, total: 0, revenue: 0 });
            const [adminAuthenticated, setAdminAuthenticated] = React.useState(false);
            const [toastMessage, setToastMessage] = React.useState('');
            const [toastType, setToastType] = React.useState('success');
            const [showToast, setShowToast] = React.useState(false);
            const [loading, setLoading] = React.useState(true);

            // Cargar datos
            React.useEffect(() => {
                loadData();
                const interval = setInterval(loadData, 5000); // Refresh cada 5 segundos
                return () => clearInterval(interval);
            }, []);

            const loadData = async () => {
                try {
                    const [servicesRes, bookingsRes, statsRes] = await Promise.all([
                        api.getServices(),
                        api.getBookings(),
                        api.getStats()
                    ]);
                    
                    setServices(servicesRes);
                    setBookings(bookingsRes);
                    setStats(statsRes);
                    setLoading(false);
                } catch (err) {
                    console.error('Error cargando datos:', err);
                    showToastMessage('Error al conectar con el servidor', 'error');
                }
            };

            const showToastMessage = (message, type = 'success') => {
                setToastMessage(message);
                setToastType(type);
                setShowToast(true);
                setTimeout(() => setShowToast(false), 3000);
            };

            const handleNavigate = (page) => {
                setCurrentPage(page);
                window.scrollTo(0, 0);
            };

            const handleBook = (service) => {
                setSelectedService(service);
                handleNavigate('booking');
            };

            const handleBookingSubmit = async (formData) => {
                try {
                    await api.createBooking(formData);
                    showToastMessage('¬°Reserva enviada! El administrador se pondr√° en contacto pronto.');
                    await loadData();
                    setTimeout(() => handleNavigate('home'), 2000);
                } catch (err) {
                    showToastMessage(err.message || 'Error al crear la reserva', 'error');
                }
            };

            const handleAdminLogin = (password) => {
                if (password === 'kikabraids2026') {
                    setAdminAuthenticated(true);
                    showToastMessage('Sesi√≥n iniciada correctamente');
                    handleNavigate('admin-dashboard');
                    return true;
                }
                return false;
            };

            const handleAdminLogout = () => {
                setAdminAuthenticated(false);
                showToastMessage('Sesi√≥n cerrada');
                handleNavigate('home');
            };

            const handleCompleteBooking = async (bookingId) => {
                try {
                    await api.updateBooking(bookingId, 'completed');
                    showToastMessage('Reserva marcada como completada');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al actualizar reserva', 'error');
                }
            };

            const handleDeleteBooking = async (bookingId) => {
                if (confirm('¬øEst√°s seguro de que deseas eliminar esta reserva?')) {
                    try {
                        await api.deleteBooking(bookingId);
                        showToastMessage('Reserva eliminada');
                        await loadData();
                    } catch (err) {
                        showToastMessage('Error al eliminar reserva', 'error');
                    }
                }
            };

            const handleAddProduct = async (product) => {
                try {
                    await api.createService(product);
                    showToastMessage('Servicio agregado exitosamente');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al agregar servicio', 'error');
                }
            };

            const handleUpdateProduct = async (id, product) => {
                try {
                    await api.updateService(id, product);
                    showToastMessage('Servicio actualizado exitosamente');
                    await loadData();
                } catch (err) {
                    showToastMessage('Error al actualizar servicio', 'error');
                }
            };

            const handleDeleteProduct = async (productId) => {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este servicio?')) {
                    try {
                        await api.deleteService(productId);
                        showToastMessage('Servicio eliminado');
                        await loadData();
                    } catch (err) {
                        showToastMessage('Error al eliminar servicio', 'error');
                    }
                }
            };

            if (loading) {
                return <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh', fontSize: '1.5rem' }}>‚è≥ Cargando...</div>;
            }

            return (
                <>
                    <Header currentPage={currentPage} onNavigate={handleNavigate} />
                    
                    {currentPage === 'home' && <HomePage services={services} onNavigate={handleNavigate} onBook={handleBook} />}
                    {currentPage === 'women' && <WomenPage services={services} onBook={handleBook} />}
                    {currentPage === 'men' && <MenPage services={services} onBook={handleBook} />}
                    {currentPage === 'gallery' && <GalleryPage />}
                    {currentPage === 'booking' && <BookingPage services={services} onBookingSubmit={handleBookingSubmit} selectedService={selectedService} />}
                    
                    {currentPage === 'admin' && !adminAuthenticated && <AdminLogin onLogin={handleAdminLogin} />}
                    {currentPage === 'admin-dashboard' && adminAuthenticated && (
                        <AdminDashboard 
                            bookings={bookings} 
                            services={services}
                            stats={stats}
                            onLogout={handleAdminLogout}
                            onCompleteBooking={handleCompleteBooking}
                            onDeleteBooking={handleDeleteBooking}
                            onAddProduct={handleAddProduct}
                            onUpdateProduct={handleUpdateProduct}
                            onDeleteProduct={handleDeleteProduct}
                        />
                    )}

                    <Footer onNavigate={handleNavigate} />
                    
                    <Toast message={toastMessage} type={toastType} visible={showToast} />
                </>
            );
        };

        // Renderizar la aplicaci√≥n
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
